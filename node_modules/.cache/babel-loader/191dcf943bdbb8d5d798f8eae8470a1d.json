{"remainingRequest":"C:\\Users\\ceyla\\Desktop\\vueProjects\\github\\LepitReads\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\ceyla\\Desktop\\vueProjects\\github\\LepitReads\\src\\composables\\getCollection.js","dependencies":[{"path":"C:\\Users\\ceyla\\Desktop\\vueProjects\\github\\LepitReads\\src\\composables\\getCollection.js","mtime":1621562730479},{"path":"C:\\Users\\ceyla\\Desktop\\vueProjects\\github\\LepitReads\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ceyla\\Desktop\\vueProjects\\github\\LepitReads\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvY2V5bGEvRGVza3RvcC92dWVQcm9qZWN0cy9naXRodWIvTGVwaXRSZWFkcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiQzovVXNlcnMvY2V5bGEvRGVza3RvcC92dWVQcm9qZWN0cy9naXRodWIvTGVwaXRSZWFkcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0IHsgcmVmLCB3YXRjaEVmZmVjdCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHByb2plY3RGaXJlc3RvcmUgfSBmcm9tICcuLi9maXJlYmFzZS9jb25maWcnOwoKdmFyIGdldENvbGxlY3Rpb24gPSBmdW5jdGlvbiBnZXRDb2xsZWN0aW9uKGNvbGxlY3Rpb24sIHF1ZXJ5MSwgcXVlcnkyKSB7CiAgdmFyIGRvY3VtZW50cyA9IHJlZihudWxsKTsKICB2YXIgZXJyb3IgPSByZWYobnVsbCk7IC8vIHJlZ2lzdGVyIHRoZSBmaXJlc3RvcmUgY29sbGVjdGlvbiByZWZlcmVuY2UKCiAgdmFyIGNvbGxlY3Rpb25SZWYgPSBwcm9qZWN0RmlyZXN0b3JlLmNvbGxlY3Rpb24oY29sbGVjdGlvbikub3JkZXJCeSgnY3JlYXRlZEF0Jyk7CgogIGlmIChxdWVyeTEpIHsKICAgIHZhciBfY29sbGVjdGlvblJlZiR3aGVyZSwgX2NvbGxlY3Rpb25SZWY7CgogICAgY29sbGVjdGlvblJlZiA9IChfY29sbGVjdGlvblJlZiR3aGVyZSA9IChfY29sbGVjdGlvblJlZiA9IGNvbGxlY3Rpb25SZWYpLndoZXJlLmFwcGx5KF9jb2xsZWN0aW9uUmVmLCBfdG9Db25zdW1hYmxlQXJyYXkocXVlcnkxKSkpLndoZXJlLmFwcGx5KF9jb2xsZWN0aW9uUmVmJHdoZXJlLCBfdG9Db25zdW1hYmxlQXJyYXkocXVlcnkyKSk7CiAgfQoKICB2YXIgdW5zdWIgPSBjb2xsZWN0aW9uUmVmLm9uU25hcHNob3QoZnVuY3Rpb24gKHNuYXApIHsKICAgIHZhciByZXN1bHRzID0gW107CiAgICBzbmFwLmRvY3MuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7CiAgICAgIC8vIG11c3Qgd2FpdCBmb3IgdGhlIHNlcnZlciB0byBjcmVhdGUgdGhlIHRpbWVzdGFtcCAmIHNlbmQgaXQgYmFjawogICAgICBkb2MuZGF0YSgpLmNyZWF0ZWRBdCAmJiByZXN1bHRzLnB1c2goX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBkb2MuZGF0YSgpKSwge30sIHsKICAgICAgICBpZDogZG9jLmlkCiAgICAgIH0pKTsKICAgIH0pOyAvLyB1cGRhdGUgdmFsdWVzCgogICAgZG9jdW1lbnRzLnZhbHVlID0gcmVzdWx0czsKICAgIGVycm9yLnZhbHVlID0gbnVsbDsKICB9LCBmdW5jdGlvbiAoZXJyKSB7CiAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7CiAgICBkb2N1bWVudHMudmFsdWUgPSBudWxsOwogICAgZXJyb3IudmFsdWUgPSAnY291bGQgbm90IGZldGNoIHRoZSBkYXRhJzsKICB9KTsKICB3YXRjaEVmZmVjdChmdW5jdGlvbiAob25JbnZhbGlkYXRlKSB7CiAgICBvbkludmFsaWRhdGUoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdW5zdWIoKTsKICAgIH0pOwogIH0pOwogIHJldHVybiB7CiAgICBlcnJvcjogZXJyb3IsCiAgICBkb2N1bWVudHM6IGRvY3VtZW50cwogIH07Cn07CgpleHBvcnQgZGVmYXVsdCBnZXRDb2xsZWN0aW9uOw=="},{"version":3,"sources":["C:/Users/ceyla/Desktop/vueProjects/github/LepitReads/src/composables/getCollection.js"],"names":["ref","watchEffect","projectFirestore","getCollection","collection","query1","query2","documents","error","collectionRef","orderBy","where","unsub","onSnapshot","snap","results","docs","forEach","doc","data","createdAt","push","id","value","err","console","log","message","onInvalidate"],"mappings":";;;AAAA,SAASA,GAAT,EAAcC,WAAd,QAAiC,KAAjC;AACA,SAASC,gBAAT,QAAiC,oBAAjC;;AAEA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,UAAD,EAAaC,MAAb,EAAqBC,MAArB,EAAgC;AAEpD,MAAMC,SAAS,GAAGP,GAAG,CAAC,IAAD,CAArB;AACA,MAAMQ,KAAK,GAAGR,GAAG,CAAC,IAAD,CAAjB,CAHoD,CAKpD;;AACA,MAAIS,aAAa,GAAGP,gBAAgB,CAACE,UAAjB,CAA4BA,UAA5B,EACjBM,OADiB,CACT,WADS,CAApB;;AAGA,MAAIL,MAAJ,EAAY;AAAA;;AACVI,IAAAA,aAAa,GAAG,0CAAAA,aAAa,EAACE,KAAd,0CAAuBN,MAAvB,IAA+BM,KAA/B,gDAAwCL,MAAxC,EAAhB;AACD;;AAED,MAAMM,KAAK,GAAGH,aAAa,CAACI,UAAd,CAAyB,UAAAC,IAAI,EAAI;AAC7C,QAAIC,OAAO,GAAG,EAAd;AACAD,IAAAA,IAAI,CAACE,IAAL,CAAUC,OAAV,CAAkB,UAAAC,GAAG,EAAI;AACvB;AACAA,MAAAA,GAAG,CAACC,IAAJ,GAAWC,SAAX,IAAwBL,OAAO,CAACM,IAAR,iCAAiBH,GAAG,CAACC,IAAJ,EAAjB;AAA6BG,QAAAA,EAAE,EAAEJ,GAAG,CAACI;AAArC,SAAxB;AACD,KAHD,EAF6C,CAO7C;;AACAf,IAAAA,SAAS,CAACgB,KAAV,GAAkBR,OAAlB;AACAP,IAAAA,KAAK,CAACe,KAAN,GAAc,IAAd;AACD,GAVa,EAUX,UAAAC,GAAG,EAAI;AACRC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB;AACApB,IAAAA,SAAS,CAACgB,KAAV,GAAkB,IAAlB;AACAf,IAAAA,KAAK,CAACe,KAAN,GAAc,0BAAd;AACD,GAda,CAAd;AAgBAtB,EAAAA,WAAW,CAAC,UAAC2B,YAAD,EAAkB;AAC5BA,IAAAA,YAAY,CAAC;AAAA,aAAMhB,KAAK,EAAX;AAAA,KAAD,CAAZ;AACD,GAFU,CAAX;AAIA,SAAO;AAAEJ,IAAAA,KAAK,EAALA,KAAF;AAASD,IAAAA,SAAS,EAATA;AAAT,GAAP;AACD,CAlCD;;AAoCA,eAAeJ,aAAf","sourcesContent":["import { ref, watchEffect } from 'vue'\nimport { projectFirestore } from '../firebase/config'\n\nconst getCollection = (collection, query1, query2) => {\n\n  const documents = ref(null)\n  const error = ref(null)\n\n  // register the firestore collection reference\n  let collectionRef = projectFirestore.collection(collection)\n    .orderBy('createdAt')\n  \n  if (query1) {\n    collectionRef = collectionRef.where(...query1).where(...query2);\n  }\n\n  const unsub = collectionRef.onSnapshot(snap => {\n    let results = []\n    snap.docs.forEach(doc => {\n      // must wait for the server to create the timestamp & send it back\n      doc.data().createdAt && results.push({...doc.data(), id: doc.id})\n    });\n    \n    // update values\n    documents.value = results\n    error.value = null\n  }, err => {\n    console.log(err.message)\n    documents.value = null\n    error.value = 'could not fetch the data'\n  })\n\n  watchEffect((onInvalidate) => {\n    onInvalidate(() => unsub());\n  });\n\n  return { error, documents }\n}\n\nexport default getCollection"]}]}